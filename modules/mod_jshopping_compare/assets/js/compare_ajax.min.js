jQuery(function(){"use strict";function e(){jQuery("body").append('<div id="alert_compare" class="modal-alert-compare '+P+" modal fade "+k+'" tabindex="-1" role="dialog" aria-labelledby="alert_compareLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"><p>'+f+'</p><div class="compare_modal_link"><p><a href="'+S+'">'+Q+"</a></p></div></div></div></div>"),jQuery("#alert_compare").modal()}function a(){jQuery("body").append('<div id="modal_compare" class="modal-compare '+P+" modal fade "+k+'" tabindex="-1" role="dialog" aria-labelledby="modal-compareLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"></div></div></div></div>'),jQuery("#modal_compare .modal-body").empty(),jQuery("#compare_table_content").appendTo("#modal_compare .modal-body"),jQuery("#modal_compare").modal(),jQuery("#modal_compare").on("hidden.bs.modal",function(){if("1"===s&&M.text()>=p)return e(),!1})}function o(e){jQuery("a.compare_link_to_list[data-id='comparelist_"+e+"']").addClass("compare_dnone"),"bs4"===x?jQuery("a.compare_link_to_list[data-id='comparelist_"+e+"']").tooltip("dispose"):jQuery("a.compare_link_to_list[data-id='comparelist_"+e+"']").tooltip("destroy"),jQuery("a.remove_compare_list[data-id='removelistid_"+e+"']").removeClass("compare_dnone"),setTimeout(function(){jQuery("a.remove_compare_list[data-id='removelistid_"+e+"']").tooltip("hide")},1500),jQuery("a.go_to_compre_list[data-id='gotocomparelist_"+e+"']").removeClass("compare_dnone"),jQuery("#compare_"+e).addClass("compare_dnone"),jQuery("#removeid_"+e).removeClass("compare_dnone"),jQuery("#gotocompare_"+e).removeClass("compare_dnone"),jQuery("button.list-btn.cp").attr("data-original-title",Q)}function t(e){jQuery("a.compare_link_to_list[data-id='comparelist_"+e+"']").removeClass("compare_dnone"),setTimeout(function(){jQuery("a.compare_link_to_list[data-id='comparelist_"+e+"']").tooltip("hide")},1500),jQuery("a.remove_compare_list[data-id='removelistid_"+e+"']").addClass("compare_dnone"),"bs4"===x?jQuery("a.remove_compare_list[data-id='removelistid_"+e+"']").tooltip("dispose"):jQuery("a.remove_compare_list[data-id='removelistid_"+e+"']").tooltip("destroy"),jQuery("a.go_to_compre_list[data-id='gotocomparelist_"+e+"']").addClass("compare_dnone"),jQuery("#compare_"+e).removeClass("compare_dnone"),jQuery("#removeid_"+e).addClass("compare_dnone"),jQuery("#gotocompare_"+e).addClass("compare_dnone"),jQuery(".compare_mod_"+e).remove(),jQuery("button.list-btn.cp").attr("data-original-title",v)}function r(){if("1"===s&&M.text()>=p)return"1"===_?e():alert(f),"max"}function d(){"0"===M.text()&&(jQuery(".go_to_compre_mod").addClass("compare_dnone"),jQuery(".empty_compare_text").removeClass("compare_dnone")),"compare"===w&&jQuery(".dopcompare").length&&location.reload()}function i(e){u="",y="",JSON.parse(e,function(e,a){"ids"===e&&(u+="<div class='compare_mod_"+a+" extern_row_compare' >"),"image"===e&&(u+="<div class='compare_mod_img pict'><span class='pict'><img src='"+a+"'/></span></div>"),"link"===e&&(u+="<div class='compare_mod_name name'><span class='name'>"+a+"</span>"),"price"===e&&(u+="<div class='price'><span class='summ'>"+a+"</span></div></div>"),"remove"===e&&(u+="<div class='compare_mod_remove delete'><span class='delete'>"+a+"</span></div></div>"),"count"===e&&(y+=a)}),"1"===_?jQuery(".mycompare_table").html("<div class='compare_mode_table extern_content_compare'>"+u+"</div><div id='compare_table_content'><div class='compare_modal_header'><H2>"+h+"</H2></div><div class='compare_mode_table extern_content_compare'>"+u+"</div><div class='compare_comeback'><a href='#'>"+g+"</a></div><div class='compare_modal_link'><a href='"+S+"'>"+j+"</a></div></div>"):jQuery(".mycompare_table").html("<div class='compare_mode_table extern_content_compare'>"+u+"</div>"),M.empty(),M.html(y.length),jQuery(".go_to_compre_mod").removeClass("compare_dnone"),jQuery(".empty_compare_text").addClass("compare_dnone"),"0"===M.text()&&(jQuery(".go_to_compre_mod").addClass("compare_dnone"),jQuery(".empty_compare_text").removeClass("compare_dnone"))}function m(){var e=jQuery(window).width(),a=jQuery(window).height(),o=jQuery(document).scrollTop(),t=jQuery(document).scrollLeft(),r=jQuery("#jshop_module_compare"),d=r.offset(),i=r.height(),m=r.width(),c=o,n=o+a,l=t,p=t+e;return d.top>c&&d.top+i<n&&d.left>l&&d.left+m<p}function c(e,a){function o(){return".new-clone-img"}var t,r;jQuery(".jshop_list_product").length&&jQuery(".image_block img").length&&(t=jQuery(".productitem_"+e+" .image_block img").not(".product_label img").attr("src")),jQuery(".productfull").length&&(t=jQuery("img[id^='main_image_']").eq(0).attr("src")),a.parents(".dop_products").length&&(t=a.parents(".dop_products .modopprod_item, .dop_products .item").not(".dop_products.vertical .modopprod_item").find("a img").attr("src")),r=!jQuery(".compare-bottom-bar").length&&!jQuery(".wl-bottom-bar").length||m()?jQuery("#jshop_module_compare"):jQuery(".compare-bottom-bar");var d=a.offset(),i=d.top,c=d.left,n=r.offset(),l=n.left,p=n.top;t&&jQuery("body").append("<img class='new-clone-img' src='"+t+"'/>"),jQuery(".new-clone-img").css({position:"absolute","z-index":"9999","max-width":75,"max-height":75,"min-width":30,"min-height":30,top:i-20+"px",left:c+"px"}).stop().animate({opacity:.6,top:p,left:l+25,width:0,height:0,minWidth:0,minHeight:0},1500,function(){jQuery(o()).remove()})}function n(){var e;e=jQuery(".offcanvas-compare-wrapp").length?"":"<div class='offcanvas-compare-wrapp'></div>",jQuery(".offcanvas-compare").toggleClass("showin_compare").append(e),jQuery(".prepend-compare-text").length||jQuery(".offcanvas-compare .mycompare_content").prepend("<div class='offcanvas-compare-close'>X</div><p class='prepend-compare-text'>"+C+"</p>"),jQuery("body").toggleClass("offcanvas-on")}var l,p,s,_,u,y,j,v,Q,f,h,g,b,x,C,k,w=mod_compare_ajax_data.data_controller,T=mod_compare_ajax_data.data_uri,D=T+"index.php?option=com_jshopping&controller=compare&task=add",O=T+"index.php?option=com_jshopping&controller=compare&task=remove",S=jQuery("a.go_to_compre_mod").attr("href"),M=jQuery(".count_compare"),P=jQuery("#jshop_module_compare").data("jscolor");l=mod_params_compare.empty_text,p=mod_params_compare.compare_quantity,s=mod_params_compare.check_compare_quantity,_=mod_params_compare.compare_modal,j=mod_compare_ajax_data.data_to,v=mod_compare_ajax_data.data_add,Q=mod_compare_ajax_data.data_go,f=mod_compare_ajax_data.data_max,h=mod_compare_ajax_data.data_added,g=mod_compare_ajax_data.data_cb,b=mod_compare_ajax_data.data_ec,x=mod_compare_ajax_data.data_bsv,C=mod_compare_ajax_data.data_offcheader,jQuery("button.list-btn.cp.in-compare").attr("data-original-title",Q),jQuery("body").tooltip({selector:'[data-rel="tooltip"], [rel="tooltip"]',trigger:"hover"}),k="bs3"===x||"bs4"===x?"":"collapse";var W=jQuery('script[src*="plugins/system/joomshopkit_v2/assets/js/custom_combine.js"]').length;if(W||jQuery("body").on("click","button.list-btn.cp",function(){jQuery(".list-btn.button.cp:not('.compare_dnone')").trigger("click")}),jQuery(".btn.list-btn.button.remove_comp:not('.compare_dnone')").length&&jQuery("button.list-btn.cp").attr("data-original-title","Перейти к сравнению"),jQuery(".btn.list-btn.button.remove_comp.compare_dnone").length&&jQuery("button.list-btn.cp").attr("data-original-title","Добавить к сравнению"),jQuery("body").on("click","a.compare_link_to_list",function(e){if(e.preventDefault(),"max"===r())return!1;var t=jQuery(this).attr("data-id").split("comparelist_")[1],d=jQuery(this).attr("data-compare"),m=jQuery(this);jQuery(this).addClass("prelative").append('<div class="ajaxloadding"></div>'),jQuery.ajax({cache:!1,url:D,data:"ids="+t+"&"+d,type:"POST",ifModified:!0,success:function(e){jQuery(".ajaxloadding").remove(),jQuery(this).removeClass("prelative"),i(e),"2"===_&&c(t,m),o(t),"1"===_?(jQuery("body").on("click",".compare_comeback",function(e){e.preventDefault(),jQuery(".modal").modal("hide")}),a()):"1"===s&&M.text()>=p&&setTimeout(function(){return alert(f),!1},1500),"compare"===w&&jQuery(".dopcompare").length&&location.reload()},error:function(){jQuery(".ajaxloadding").remove(),jQuery(this).removeClass("prelative")}})}),jQuery("body").on("click","a.remove_compare_list",function(e){e.preventDefault();var a=jQuery(this).attr("data-id").split("removelistid_")[1];jQuery(this).addClass("prelative").append('<div class="ajaxloadding"></div>'),jQuery.ajax({cache:!1,url:O,data:"removeid="+a,type:"POST",ifModified:!0,success:function(){jQuery(".ajaxloadding").remove(),jQuery(this).removeClass("prelative"),t(a),M.html(M.text()-1),d()},error:function(){jQuery(".ajaxloadding").remove(),jQuery(this).removeClass("prelative")}})}),jQuery("body").on("click",".comp_add",function(e){if(e.preventDefault(),"bs4"===x?jQuery(".tooltip.in").tooltip("dispose"):jQuery(".tooltip.in").tooltip("destroy"),(jQuery(e.target).is("[class*='icon-']")||jQuery(e.target).is("button.list-btn.cp"))&&jQuery(".comp_add").trigger("click"),"max"===r())return!1;var t=jQuery(this).attr("id").split("compare_")[1],d=jQuery(this).attr("data-compare"),m=jQuery(this).parent("div");jQuery(this).parent().addClass("prelative").append('<div class="ajaxloadding"></div>'),jQuery.ajax({cache:!1,url:D,data:"ids="+t+"&"+d,type:"POST",ifModified:!0,success:function(e){jQuery(".ajaxloadding").remove(),jQuery(this).parent().removeClass("prelative"),i(e),"2"===_&&c(t,m),o(t),"1"===_?(jQuery("body").on("click",".compare_comeback",function(e){e.preventDefault(),jQuery(".modal").modal("hide")}),a()):"1"===s&&M.text()>=p&&setTimeout(function(){return alert(f),!1},1500)},error:function(){jQuery(".ajaxloadding").remove(),jQuery(this).parent().removeClass("prelative")}})}),jQuery("body").on("click",".remove_comp",function(e){e.preventDefault();var a=jQuery(this).attr("id").split("removeid_")[1];jQuery(this).parent().addClass("prelative").append('<div class="ajaxloadding"></div>'),jQuery.ajax({cache:!1,url:O,data:"removeid="+a,type:"POST",ifModified:!0,success:function(){jQuery(".ajaxloadding").remove(),jQuery(this).parent().removeClass("prelative"),t(a),M.html(M.text()-1),"0"===M.text()&&(jQuery(".go_to_compre_mod").addClass("compare_dnone"),jQuery(".empty_compare_text").removeClass("compare_dnone"))},error:function(){jQuery(".ajaxloadding").remove(),jQuery(this).parent().removeClass("prelative")}})}),jQuery("body").on("click","a.remove_compare_view",function(e){e.preventDefault();var a=jQuery(this).attr("id").split("removeviewid_")[1];jQuery(this).addClass("prelative").append('<div class="ajaxloadding"></div>'),jQuery.ajax({cache:!1,url:O,data:"removeid="+a,type:"POST",ifModified:!0,success:function(){jQuery(".ajaxloadding").remove(),jQuery(this).removeClass("prelative"),jQuery(".compare_view_"+a).remove(),jQuery(".compare_mod_"+a).remove(),M.html(M.text()-1),d(),"compare"===w&&jQuery(".dopcompare").length&&location.reload()},error:function(){jQuery(".ajaxloadding").remove(),jQuery(this).removeClass("prelative")}})}),jQuery("body").on("click","a.remove_compare_mod",function(e){e.preventDefault();var a=jQuery(this).attr("id").split("removemodid_")[1];jQuery(this).addClass("prelative").append('<div class="ajaxloadding"></div>'),jQuery.ajax({cache:!1,url:O,data:"removeid="+a,type:"POST",ifModified:!0,success:function(){jQuery(".ajaxloadding").remove(),jQuery(this).removeClass("prelative"),t(a),jQuery(".compare_view_"+a).remove(),M.html(M.text()-1),"0"===M.text()&&(jQuery(".go_to_compre_mod, .compare_modal_header, .compare_modal_link, .compare_comeback").addClass("compare_dnone"),jQuery("#sbox-content .compare_mode_table").html("<tr><td style='text-align:center;'>"+b+"</td></tr>"),jQuery(".empty_compare_text").removeClass("compare_dnone"),jQuery("#modal_compare .modal-body").html(b)),"compare"===w&&jQuery(".dopcompare").length&&location.reload()},error:function(){jQuery(".ajaxloadding").remove(),jQuery(this).removeClass("prelative")}})}),jQuery("body").on("click",".click_mycompare, .offcanvas-compare-close, .offcanvas-compare-wrapp",function(e){e.preventDefault(),jQuery(".mycompare_content").fadeToggle(),n()}),jQuery(".js-event-prevent .compare-bottom-bar").click(function(){jQuery(".offcanvas-compare .mycompare_content").fadeIn("5000"),n()}),"0"===M.text()?jQuery(".empty_compare_text").html("<span>"+l+"</span>"):jQuery(".empty_compare_text").html("<span>"+l+"</span>").addClass("compare_dnone"),jQuery(".min_view.compare-wrapp").length){var q=jQuery(".min_view.compare-wrapp"),H=jQuery(".mycompare_content"),L=q.outerWidth(),z=H.outerWidth(),I=q.offset(),J=I.left,N=jQuery(window).outerWidth()-J;J<z/2-L||N<z/2-L?H.css({left:-J}):H.css({left:-(z/2-L/2)})}});